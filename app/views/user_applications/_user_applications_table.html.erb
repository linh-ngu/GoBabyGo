<div class="mt-3 font-bold text-lg flex justify-center items-center mb-3">Sort By:
  <select id="sortOption" class="ml-3 text-black bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center">
    <option value="created_at_desc" <%= params[:sort_option] == "created_at_desc" ? "selected" : "" %>>Newest to oldest</option>
    <option value="created_at_asc" <%= params[:sort_option] == "created_at_asc" ? "selected" : "" %>>Oldest to newest</option>
  </select>
</div>
<div class="mt-3 font-bold text-lg flex justify-center items-center mb-3"><label class="ml-3 mr-3">Filter by:</label>
  <%= form_tag(user_applications_path, method: :get) do %>
    <label class="mx-2">
      <%= check_box_tag :my_applications, 1, params[:my_applications] == "1"%>
      My Applications
    </label>
    <label class="mx-2">
      <%= check_box_tag :accepted, 1, params[:accepted] == "1" %>
      Accepted
    </label>
    <label class="mx-2">
      <%= check_box_tag :waitlist, 1, params[:waitlist] == "1" %>
      Waitlist
    </label>
    <label class="mx-2">
      <%= check_box_tag :not_accepted, 1, params[:not_accepted] == "1" %>
      Not Accepted
    </label>
    <label class = "px-2 py-3">
      Applied within:
      <%= date_field_tag :start_date, params[:start_date], placeholder: "Start Date", class: "w-36 mt-5 px-2 py-1 border rounded" %> - <%= date_field_tag :end_date, params[:end_date], placeholder: "End Date", class: "w-36 px-2 py-1 border rounded" %>
    </label>
    <%= submit_tag "Apply Filters", class: "text-white bg-blue-700 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2" %>
    <br />
  <% end %>
</div>
<div class='flex flex-col justify-center items-center border border-black bg-gray-300 rounded-lg min-w-2/3 w-2/3 mx-auto'>
  <div class="my-5 font-bold text-4xl"><%= @page_title %></div>
  <table class="w-full mx-auto shadow rounded-md border border-gray-200 outline-none px-3 py-2 bg-white">
    <thead>
      <tr>
        <th class="border border-gray-200 px-3 py-2 flex justify-left">Date Created</th>
        <th class="border border-gray-200 px-3 py-2 justify-left">Child Name</th>
        <th class="border border-gray-200 px-3 py-2">Status</th>
        <th class="border border-gray-200 px-3 py-2"> Application Actions</th>
      </tr>
    </thead>
    <tbody>
      <% user_applications.each_with_index do |user_application, index| %>
        <tr class="<%= index.odd? ? 'bg-gray-100' : 'bg-white' %> border-t border-gray-200">
          <td class="border border-gray-200 px-3 py-2"><%= user_application.created_at.strftime("%Y-%m-%d") %></td>
          <td class="border border-gray-200 px-3 py-2">
            <div class="text-lg font-semibold"><%= user_application.child_first_name + " " + user_application.child_last_name %></div>
          </td>
          <td class="border border-gray-200 px-3 py-2">
            <% status_color = case
                              when user_application.accepted == true
                                'bg-green-500'
                              when user_application.accepted.nil?
                                'bg-white'
                              when user_application.waitlist == true
                                'bg-blue-500'
                              else
                                'bg-red-500'
                            end %>
            <span class="inline-block h-4 w-4 rounded-full border border-black mr-2 <%= status_color %>"></span>
            <% if user_application.accepted.nil? %>
              <span class="text-black">Pending</span>
            <% elsif user_application.accepted == false && user_application.waitlist == false %>
              <span class="text-red-500">Denied</span>
            <% elsif user_application.waitlist == true %>
              <span class="text-blue-500">Waitlisted</span>
            <% elsif user_application.accepted == true %>
              <span class="text-green-500">Accepted</span>
            <% end %>
          </td>
          <td class="border border-gray-200 px-3 py-2">
            <div class="flex justify-center">
              <%= link_to("View", user_application_path(user_application), class: view_link_class)%>
              <%= link_to("Change Status", edit_user_application_path(user_application), class: status_link_class)%>
              <% if action_name == 'archive' %>
                <%= button_to("Unarchive", {controller: "user_applications", action: "update", id: user_application.id, button: 'unarchive'}, {class: status_link_class, method: :put}) %>
              <% else %> 
                <%= button_to("Archive", {controller: "user_applications", action: "update", id: user_application.id, button: 'archive'}, {class: status_link_class, method: :put}) %>
              <% end %>
              <% if @user.officer_member? || @user.admin? %>
                <%= link_to("Delete", delete_user_application_path(user_application), class: delete_link_class)%>
              <% end %>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<div class='mt-8'><%= link_to('<- Back to Dashboard', dashboard_path, class:'rounded-lg ml-3 py-2 px-3 bg-gray-500 text-white inline-block font-medium cursor-pointer hover:bg-gray-600') %></div>


<script>
  document.addEventListener("DOMContentLoaded", function() {
    const showFiltersBtn = document.getElementById("showFiltersBtn");
    const clearFiltersBtn = document.getElementById("clearFiltersBtn");
    const filterOptions = document.querySelector(".filter-options");

    showFiltersBtn.addEventListener("click", function() {
      if (filterOptions.classList.contains("hidden")) {
        filterOptions.classList.remove("hidden");
        showFiltersBtn.textContent = "Hide Filters";
      } else {
        filterOptions.classList.add("hidden");
        showFiltersBtn.textContent = "Show Filters";
      }
    });

    clearFiltersBtn.addEventListener("click", function() {
      // Uncheck all filter checkboxes
      document.querySelectorAll("input[type='checkbox']").forEach(function(checkbox) {
        checkbox.checked = false;
      });
      // Submit the form to apply cleared filters
      filterOptions.querySelector("form").submit();
    });
  });
</script>

<div class="user_applications index py-10">
  <% if @user.officer_member? %>
    <div class="filter-toggle mb-5">
      <button id="showFiltersBtn" class="ml-3 py-1 px-2 bg-gray-500 text-white inline-block cursor-pointer rounded-md shadow-xl hover:bg-gray-600">Show Filters</button>
      <% if params[:accepted].present? || params[:waitlist].present? || params[:not_accepted].present? || params[:start_date].present? || params[:end_date].present? || params[:min_height].present? || params[:max_height].present?%>
        <button id="clearFiltersBtn" class="rounded-lg ml-3 py-2 px-3 bg-red-600 text-white inline-block font-medium cursor-pointer">Clear Filters</button>
      <% end %>
    </div>

    <div class="filter-options hidden ml-3">
      <h3 class="text-lg font-semibold mb-3">Filter Options:</h3>
      <%= form_tag(user_applications_path, method: :get) do %>
        <label>
          <%= check_box_tag :accepted, 1, params[:accepted] == "1" %>
          Accepted
        </label>
        <label>
          <%= check_box_tag :waitlist, 1, params[:waitlist] == "1" %>
          Waitlist
        </label>
        <label >
          <%= check_box_tag :not_accepted, 1, params[:not_accepted] == "1" %>
          Not Accepted
        </label>
        <br />
        <br />
        <label>
          Application Date Range:
          <%= text_field_tag :start_date, params[:start_date], placeholder: "Start Date" %>
          <%= text_field_tag :end_date, params[:end_date], placeholder: "End Date" %>
        </label>
        <br />
        <br />
        <label class="mt-3">
          Child Height Range (35-45):
          <%= text_field_tag :min_height, params[:min_height], placeholder: "Min Height" %>
          <%= text_field_tag :max_height, params[:max_height], placeholder: "Max Height" %>
        </label>
        <br />
        <%= submit_tag "Apply Filters", class: "rounded-lg mt-5 py-2 px-3 bg-blue-600 text-white inline-block font-medium cursor-pointer" %>
      <% end %>
    </div>
  <% end %>
  <h2 class="text-2xl font-bold ml-3"><%= @page_title %></h2>
  <br />
  <% if @user.applicant? %>
    <table class="listing w-full">
      <tr class="header">
        <th>Applicant Name</th>
      </tr>
      <% @user_applications.each do |user_application| %>
        <tr>
          <td><%= user_application.child_name %></td>
          <td class="actions">
            <%= link_to("Show", user_application_path(user_application), class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer")%>
            <%= link_to("Edit", edit_user_application_path(user_application), class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer")%>
            <%= link_to("Delete", delete_user_application_path(user_application), class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer")%>
          </td>
        </tr>
      <% end %>
    </table>
    <br />
    <br />
  <% end %>

  <% if @user.officer_member? %>
    <%= render partial: 'user_applications_table', locals: { 
      title: "Accepted", 
      user_applications: @accepted_user_applications, 
      view_link_class: "action show rounded-lg py-2 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      reject_link_class: "action reject rounded-lg py-2 px-4 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      table_class: "accepted",
      header_color: "green-800"
    } %>
    <br />
    <%= render partial: 'user_applications_table', locals: { 
      title: "Waitlisted", 
      user_applications: @waitlist_user_applications,
      view_link_class: "action show rounded-lg py-2 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      accept_link_class: "action accept rounded-lg py-2 px-3 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      reject_link_class: "action reject rounded-lg py-2 px-4 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      table_class: "waitlist",
      header_color: "gray-500"
    } %>
    <br />
    <%= render partial: 'user_applications_table', locals: { 
      title: "Not Accepted", 
      user_applications: @not_accepted_user_applications,
      view_link_class: "action show rounded-lg py-2 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      accept_link_class: "action accept rounded-lg py-2 px-3 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      reject_link_class: "action reject rounded-lg py-2 px-4 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      waitlist_link_class: "action waitlist rounded-lg py-2 px-3 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700",
      table_class: "not-accepted",
      header_color: "red-800"
    } %>
    <br />
  <% end %>

  <%= link_to("New Application", new_user_application_path, class:'rounded-lg ml-3 py-2 px-3 bg-gray-500 text-white inline-block font-medium cursor-pointer hover:bg-gray-600')%>
  <br />
</div>
